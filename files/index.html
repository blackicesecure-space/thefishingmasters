<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Fishing Masters | Wohin heute angeln?</title>
    <style>
      :root {
        --bg: #0b1220;
        --card: #10192b;
        --card-alt: #0f1a2f;
        --accent: #59d0ff;
        --text: #e9f3ff;
        --muted: #9db2cc;
        --ok: #77e1a5;
        --warn: #ffd17f;
        --bad: #ff9090;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        color: var(--text);
        background: radial-gradient(circle at 20% 0%, #1b2f52 0%, var(--bg) 45%);
        display: grid;
        place-items: center;
        padding: 1.25rem;
      }

      .app {
        width: min(1080px, 100%);
        background: linear-gradient(160deg, rgba(89, 208, 255, 0.08), rgba(255, 255, 255, 0.01));
        border: 1px solid rgba(89, 208, 255, 0.28);
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 45px rgba(0, 0, 0, 0.35);
      }

      header {
        padding: 1.6rem 1.6rem 1rem;
      }

      h1,
      h2,
      h3 {
        margin: 0;
      }

      h1 {
        font-size: clamp(1.4rem, 2.8vw, 2.15rem);
      }

      p {
        margin: 0.65rem 0 0;
        color: var(--muted);
      }

      .content {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
        padding: 0 1.6rem 1.6rem;
      }

      @media (min-width: 880px) {
        .content {
          grid-template-columns: 1.2fr 1fr;
        }
      }

      .card {
        background: var(--card);
        border: 1px solid rgba(157, 178, 204, 0.2);
        border-radius: 14px;
        padding: 1rem;
      }

      .controls,
      .score-explain {
        display: grid;
        gap: 0.9rem;
      }

      .field {
        display: grid;
        gap: 0.35rem;
      }

      label {
        font-weight: 600;
        font-size: 0.95rem;
      }

      input,
      select,
      button {
        border-radius: 10px;
        border: 1px solid rgba(157, 178, 204, 0.32);
        background: var(--card-alt);
        color: var(--text);
        font: inherit;
        padding: 0.65rem 0.8rem;
      }

      button {
        border: none;
        background: var(--accent);
        color: #001722;
        font-weight: 700;
        cursor: pointer;
      }

      .button-row {
        display: flex;
        gap: 0.6rem;
        flex-wrap: wrap;
      }

      .button-row button.secondary {
        background: transparent;
        color: var(--text);
        border: 1px solid rgba(157, 178, 204, 0.5);
      }

      .toplist,
      .score-explain {
        list-style: none;
        padding: 0;
        margin: 1rem 0 0;
      }

      .toplist {
        display: grid;
        gap: 0.7rem;
      }

      .toplist li,
      .score-explain li {
        border-radius: 10px;
        background: rgba(89, 208, 255, 0.08);
        padding: 0.85rem;
      }

      .toplist li {
        display: flex;
        justify-content: space-between;
        gap: 0.5rem;
      }

      .meta {
        display: block;
        font-size: 0.88rem;
        color: var(--muted);
      }

      .score {
        color: var(--ok);
        font-weight: 700;
        white-space: nowrap;
      }

      .status {
        margin-top: 0.8rem;
        padding: 0.6rem 0.75rem;
        border-radius: 8px;
        font-size: 0.92rem;
      }

      .status.info {
        background: rgba(255, 209, 127, 0.1);
        color: var(--warn);
      }

      .status.error {
        background: rgba(255, 144, 144, 0.12);
        color: var(--bad);
      }

      .tip {
        margin-top: 1rem;
        color: var(--muted);
        font-size: 0.95rem;
      }
    </style>
  </head>
  <body>
    <main class="app">
      <header>
        <h1>üé£ The Fishing Masters</h1>
        <p>
          Tagesempfehlungen f√ºr Mitteldeutschland: Gib aktuelle Bedingungen ein und erhalte
          eine nachvollziehbare Rangliste inkl. Begr√ºndung der Bewertung.
        </p>
      </header>

      <section class="content">
        <article class="card">
          <h2>Heute empfohlen</h2>
          <p id="contextLine">Ort: Leipzig | Zielfisch: Zander | Saison: Fr√ºhling</p>
          <ul class="toplist" id="results" aria-live="polite"></ul>
          <p class="tip" id="tip"></p>
          <p class="status info" id="statusLine"></p>

          <h3 style="margin-top: 1rem">Score-Aufschl√ºsselung (Top 1)</h3>
          <ul class="score-explain" id="scoreExplain"></ul>
        </article>

        <article class="card">
          <h2>Schnellauswahl</h2>
          <form class="controls" id="settingsForm">
            <div class="field">
              <label for="location">Standort (Stadt)</label>
              <input id="location" name="location" type="text" maxlength="40" value="Leipzig" />
            </div>

            <div class="field">
              <label for="targetFish">Zielfisch</label>
              <select id="targetFish" name="targetFish">
                <option>Zander</option>
                <option>Hecht</option>
                <option>Karpfen</option>
                <option>Barsch</option>
                <option>Wels</option>
              </select>
            </div>

            <div class="field">
              <label for="wind">Wind (km/h)</label>
              <input id="wind" name="wind" type="number" min="0" max="80" value="14" />
            </div>

            <div class="field">
              <label for="waterTemp">Wassertemperatur (¬∞C)</label>
              <input id="waterTemp" name="waterTemp" type="number" min="0" max="30" value="13" step="0.5" />
            </div>

            <div class="field">
              <label for="season">Saison</label>
              <select id="season" name="season">
                <option>Fr√ºhling</option>
                <option>Sommer</option>
                <option>Herbst</option>
                <option>Winter</option>
              </select>
            </div>

            <div class="button-row">
              <button type="submit">Empfehlung berechnen</button>
              <button type="button" class="secondary" id="resetBtn">Zur√ºcksetzen</button>
            </div>
          </form>
          <p class="tip">Bewertung basiert auf Eignung f√ºr Zielfisch, Wind, Wassertemperatur und Saison.</p>
        </article>
      </section>
    </main>

    <script>
      const waters = [
        {
          name: 'Goitzschesee (Sachsen-Anhalt)',
          base: 80,
          species: ['Zander', 'Barsch'],
          tempRange: [9, 18],
          windTolerance: [6, 28],
          seasonBoost: { Fr√ºhling: 4, Sommer: 2, Herbst: 6, Winter: -4 }
        },
        {
          name: 'Bleilochtalsperre (Th√ºringen)',
          base: 77,
          species: ['Hecht', 'Wels'],
          tempRange: [10, 22],
          windTolerance: [4, 24],
          seasonBoost: { Fr√ºhling: 1, Sommer: 3, Herbst: 7, Winter: -6 }
        },
        {
          name: 'Cospudener See (Sachsen)',
          base: 74,
          species: ['Hecht', 'Karpfen'],
          tempRange: [12, 25],
          windTolerance: [3, 22],
          seasonBoost: { Fr√ºhling: 3, Sommer: 5, Herbst: 1, Winter: -8 }
        },
        {
          name: 'Saale bei Halle',
          base: 72,
          species: ['Wels', 'Barsch'],
          tempRange: [8, 20],
          windTolerance: [5, 26],
          seasonBoost: { Fr√ºhling: 5, Sommer: 1, Herbst: 4, Winter: -3 }
        }
      ];

      const tipByFish = {
        Zander: 'Nutze in der D√§mmerung schlanke Gummifische dicht am Grund.',
        Hecht: 'Bei Windkanten funktionieren gr√∂√üere K√∂der mit klarem Druckprofil.',
        Karpfen: 'Stabile Futterpl√§tze lohnen sich, wenn die Temperatur √ºber 12¬∞C liegt.',
        Barsch: 'Suche Strukturkanten und f√ºhre kleine K√∂der mit kurzen Pausen.',
        Wels: 'In Flussn√§he sind tiefe Rinnen und langsame F√ºhrung oft effektiv.'
      };

      function clampScore(value) {
        return Math.max(55, Math.min(97, Math.round(value)));
      }

      function penaltyFromRange(value, min, max, lowFactor, highFactor) {
        if (value < min) return (min - value) * lowFactor;
        if (value > max) return (value - max) * highFactor;
        return 0;
      }

      function validateInput(input) {
        if (!input.location.trim()) {
          return 'Bitte gib einen Standort ein.';
        }
        if (Number.isNaN(input.wind) || input.wind < 0 || input.wind > 80) {
          return 'Wind muss zwischen 0 und 80 km/h liegen.';
        }
        if (Number.isNaN(input.waterTemp) || input.waterTemp < 0 || input.waterTemp > 30) {
          return 'Wassertemperatur muss zwischen 0¬∞C und 30¬∞C liegen.';
        }
        return null;
      }

      function calculateSpotScore(spot, input) {
        const breakdown = [];
        let score = spot.base;
        breakdown.push(`Basiswert: ${spot.base}`);

        if (spot.species.includes(input.targetFish)) {
          score += 10;
          breakdown.push(`Zielfisch-Match (${input.targetFish}): +10`);
        } else {
          score -= 7;
          breakdown.push(`Zielfisch nicht prim√§r vertreten: -7`);
        }

        const seasonDelta = spot.seasonBoost[input.season] ?? 0;
        score += seasonDelta;
        breakdown.push(`Saison (${input.season}): ${seasonDelta >= 0 ? '+' : ''}${seasonDelta}`);

        const tempPenalty = penaltyFromRange(input.waterTemp, spot.tempRange[0], spot.tempRange[1], 1.5, 1.2);
        const windPenalty = penaltyFromRange(input.wind, spot.windTolerance[0], spot.windTolerance[1], 1.2, 1.0);
        score -= tempPenalty;
        score -= windPenalty;

        if (tempPenalty > 0) breakdown.push(`Temperatur au√üerhalb Optimum: -${tempPenalty.toFixed(1)}`);
        if (windPenalty > 0) breakdown.push(`Wind au√üerhalb Optimum: -${windPenalty.toFixed(1)}`);

        const finalScore = clampScore(score);
        breakdown.push(`Endscore (geclamped): ${finalScore}`);
        return { score: finalScore, breakdown };
      }

      function getInputs() {
        return {
          location: document.getElementById('location').value,
          targetFish: document.getElementById('targetFish').value,
          wind: Number(document.getElementById('wind').value),
          waterTemp: Number(document.getElementById('waterTemp').value),
          season: document.getElementById('season').value
        };
      }

      function buildRanking(input) {
        return waters
          .map((spot) => {
            const result = calculateSpotScore(spot, input);
            return {
              ...spot,
              score: result.score,
              breakdown: result.breakdown
            };
          })
          .sort((a, b) => b.score - a.score);
      }

      function setStatus(message, error = false) {
        const node = document.getElementById('statusLine');
        node.textContent = message;
        node.className = error ? 'status error' : 'status info';
      }

      function renderScoreBreakdown(lines) {
        const list = document.getElementById('scoreExplain');
        list.innerHTML = '';
        lines.forEach((line) => {
          const li = document.createElement('li');
          li.textContent = line;
          list.appendChild(li);
        });
      }

      function renderRanking(input) {
        const validationError = validateInput(input);
        if (validationError) {
          setStatus(validationError, true);
          return;
        }

        const ranking = buildRanking(input);
        const list = document.getElementById('results');
        list.innerHTML = '';

        ranking.slice(0, 3).forEach((spot, idx) => {
          const li = document.createElement('li');

          const left = document.createElement('div');
          const title = document.createElement('strong');
          title.textContent = `#${idx + 1} ${spot.name}`;

          const meta = document.createElement('span');
          meta.className = 'meta';
          meta.textContent = spot.species.includes(input.targetFish)
            ? `Zielfisch passt (${input.targetFish})`
            : `Alternative Arten: ${spot.species.join(', ')}`;

          left.appendChild(title);
          left.appendChild(meta);

          const score = document.createElement('span');
          score.className = 'score';
          score.textContent = `${spot.score}% Match`;

          li.appendChild(left);
          li.appendChild(score);
          list.appendChild(li);
        });

        const best = ranking[0];
        document.getElementById('tip').textContent = `Pro-Tipp (${input.targetFish}): ${tipByFish[input.targetFish]}`;
        document.getElementById('contextLine').textContent = `Ort: ${input.location.trim()} | Zielfisch: ${input.targetFish} | Saison: ${input.season} | Wind: ${input.wind} km/h | Wasser: ${input.waterTemp}¬∞C`;
        setStatus(`Top-Empfehlung: ${best.name} mit ${best.score}% Match.`);
        renderScoreBreakdown(best.breakdown);
      }

      function resetForm() {
        document.getElementById('location').value = 'Leipzig';
        document.getElementById('targetFish').value = 'Zander';
        document.getElementById('wind').value = '14';
        document.getElementById('waterTemp').value = '13';
        document.getElementById('season').value = 'Fr√ºhling';
      }

      document.getElementById('settingsForm').addEventListener('submit', (event) => {
        event.preventDefault();
        renderRanking(getInputs());
      });

      document.getElementById('resetBtn').addEventListener('click', () => {
        resetForm();
        renderRanking(getInputs());
      });

      renderRanking(getInputs());
    </script>
  </body>
</html>
